name: Testes Robot Framework

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]
  workflow_dispatch: # Permite execu√ß√£o manual

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout do c√≥digo
      uses: actions/checkout@v4
    
    - name: Configurar Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: Instalar depend√™ncias
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
    
    - name: Criar estrutura de diret√≥rios
      run: |
        mkdir -p reports/{html,xml,logs,screenshots}
    
<<<<<<< HEAD
    - name: Executar testes JSON
      continue-on-error: true
      run: |
        robot --outputdir reports/html \
              --output reports/xml/json-output.xml \
              --log reports/logs/json-log.html \
              --report reports/html/json-report.html \
              --include JSON \
              --name "Testes JSON" \
              tests/ || echo "Testes JSON conclu√≠dos com falhas"
    
    - name: Executar testes din√¢micos
      continue-on-error: true
      run: |
        robot --outputdir reports/html \
              --output reports/xml/dinamico-output.xml \
              --log reports/logs/dinamico-log.html \
              --report reports/html/dinamico-report.html \
              --include dinamico \
              --name "Testes Din√¢micos" \
              tests/ || echo "Testes din√¢micos conclu√≠dos com falhas"
    
    - name: Executar testes de manipula√ß√£o
      continue-on-error: true
      run: |
        robot --outputdir reports/html \
              --output reports/xml/manipulacao-output.xml \
              --log reports/logs/manipulacao-log.html \
              --report reports/html/manipulacao-report.html \
              --include MANIPULACAO \
              --name "Testes de Manipula√ß√£o" \
              tests/ || echo "Testes de manipula√ß√£o conclu√≠dos com falhas"
    
    - name: Gerar relat√≥rio consolidado
      if: always()
      run: |
        rebot --outputdir reports/html \
              --output reports/xml/consolidated-output.xml \
              --log reports/logs/consolidated-log.html \
              --report reports/html/consolidated-report.html \
              --name "Relat√≥rio Consolidado" \
              reports/xml/*-output.xml || echo "Relat√≥rio consolidado gerado"
    
    - name: Upload dos resultados
=======
    - name: Upload Test Results
>>>>>>> 5edb2254d5c9b601cbc07cb380bd174d12fc32e2
      uses: actions/upload-artifact@v4
      if: always()
      with:
        name: relatorios-robot-${{ github.run_number }}
        path: reports/
        retention-days: 30
    
    - name: Publicar resultados dos testes
      uses: EnricoMi/publish-unit-test-result-action@v2
      if: always()
      with:
        files: reports/xml/*.xml
<<<<<<< HEAD
        check_name: "Resultados dos Testes Robot Framework"
        comment_title: "üìä Relat√≥rio de Testes"
    
    - name: Coment√°rio com resumo
      if: always()
      run: |
        echo "## üìä Resumo da Execu√ß√£o" >> $GITHUB_STEP_SUMMARY
        echo "- ‚úÖ Testes JSON executados" >> $GITHUB_STEP_SUMMARY
        echo "- ‚úÖ Testes din√¢micos executados" >> $GITHUB_STEP_SUMMARY
        echo "- ‚úÖ Testes de manipula√ß√£o executados" >> $GITHUB_STEP_SUMMARY
        echo "- üìÅ Relat√≥rios dispon√≠veis nos artefatos" >> $GITHUB_STEP_SUMMARY
=======
>>>>>>> 5edb2254d5c9b601cbc07cb380bd174d12fc32e2
